generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

/**
 * 방문 기록 (History)
 * 
 * 사용자가 방문한 웹사이트 목록 저장
 * 검색/추천 기능에 사용됨
 */
model History {
  id        String   @id @default(cuid())
  url       String
  title     String?
  favicon   String?
  visitedAt DateTime @default(now())

  @@index([visitedAt]) // 최신순 조회 최적화
  @@index([url, visitedAt])
}

/**
 * 북마크 (Bookmark)
 * 
 * 중요한 웹사이트 저장
 * 폴더 구조 지원
 */
model Bookmark {
  id        String   @id @default(cuid())
  url       String   @unique
  title     String?
  favicon   String?
  folder    String   @default("root") // 폴더 경로 (e.g., "Work/Project")
  createdAt DateTime @default(now())

  @@index([folder]) // 폴더별 조회 최적화
  @@index([folder, createdAt])
}

/**
 * 앱 설정 (Settings)
 * 
 * 키-값 스토어
 * e.g., { key: "theme", value: "dark" }
 */
model AppSetting {
  key       String   @id
  value     String
  updatedAt DateTime @updatedAt
}

enum SessionTabSection {
  icon
  space
  tab
}

/**
 * 세션 탭 (SessionTab)
 * 
 * 앱 시작 시 마지막 탭 상태 복구용
 * 
 * type: 'icon' | 'space' | 'tab'
 * - icon: 고정 아이콘 (favicon으로 표시)
 * - space: 핀된 탭 (스페이스 섹션)
 * - tab: 일반 탭 (탭 섹션)
 * 
 * isFavorite: Icon 섹션에 나타나는지 여부
 * isPinned: Space 섹션에 나타나는지 여부
 */
model SessionTab {
  id        String   @id @default(cuid())
  url       String
  title     String?
  favicon   String?
  isActive  Boolean  @default(false)
  section   SessionTabSection @default(tab) // 'icon' | 'space' | 'tab'
  position  Int      @default(0)          // 섹션 내 순서

  @@index([isActive])
  @@index([section])
  @@index([section, position])
}
